{% extends "base.html" %}
{% load static heroicons %}

{% block body_class %}{% endblock %}
{% block content %}
  
<div 
x-data="{ 
	menuOpen: false, 
	basicSignInModal: false,
	basicSignUpModal: false,
	advanceSignInModal: false,
	advanceSignUpModal: false,
}" 
class="flex flex-col min-h-screen custom-scrollbar"
>
<!-- start::Black overlay -->
<div :class="menuOpen ? 'block' : 'hidden'" @click="menuOpen = false" class="fixed  inset-0 bg-black opacity-50 transition-opacity lg:hidden"></div>
<!-- end::Black overlay -->
 {% include 'header.html' %}
 {% include 'tabs.html' with active_tab="logistique" %}
 <div class=" w-full flex flex-row">
	{% include "sidebar_logistiques.html" %}
  <div class="h-full w-full">
	<!-- Main content header -->
    <main class="block w-full h-full px-2 overflow-hidden" x-data="reglement()">
          <!-- Main content header -->
          <div class="flex justify-between  mt-4 px-6 ">
				  <h2 class="text-2xl font-bold mb-2 pb-2 tracking-wider uppercase">Bon de Transport</h2>
				  <div>
					  <div class="relative mr-4 inline-block">
						  <div class="text-gray-500 cursor-pointer w-10 h-10 rounded-full bg-gray-100 hover:bg-gray-300 inline-flex items-center justify-center"  @click="printInvoice()">
							  <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-printer" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
								  <rect x="0" y="0" width="24" height="24" stroke="none"></rect>
								  <path d="M17 17h2a2 2 0 0 0 2 -2v-4a2 2 0 0 0 -2 -2h-14a2 2 0 0 0 -2 2v4a2 2 0 0 0 2 2h2" />
								  <path d="M17 9v-4a2 2 0 0 0 -2 -2h-6a2 2 0 0 0 -2 2v4" />
								  <rect x="7" y="13" width="10" height="8" rx="2" />
							  </svg>				  
						  </div>
						 
					  </div>
			          <div class="relative inline-block">
						<div class="text-gray-500 cursor-pointer w-10 h-10 rounded-full bg-gray-100 hover:bg-gray-300 inline-flex items-center justify-center"  @click="openPreview=true">
							<svg id='eye_24' width='24' height='24' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><rect width='24' height='24' stroke='none' fill='#000000' opacity='0'/>
									<g transform="matrix(1 0 0 1 12 12)" >
									<g style="" >
									<g transform="matrix(1 0 0 1 0 0)" >
									<path style="stroke: none; stroke-width: 2; stroke-dasharray: none; stroke-linecap: round; stroke-dashoffset: 0; stroke-linejoin: round; stroke-miterlimit: 4; fill: none; fill-rule: nonzero; opacity: 1;" transform=" translate(-12, -12)" d="M 0 0 L 24 0 L 24 24 L 0 24 z" stroke-linecap="round" />
									</g>
									<g transform="matrix(1 0 0 1 -0.25 -0.25)" >
									<circle style="stroke: rgb(0,0,0); stroke-width: 1.5; stroke-dasharray: none; stroke-linecap: round; stroke-dashoffset: 0; stroke-linejoin: round; stroke-miterlimit: 4; fill: none; fill-rule: nonzero; opacity: 1;" cx="0" cy="0" r="2" />
									</g>
									<g transform="matrix(1 0 0 1 -0.25 -0.25)" >
									<path style="stroke: rgb(0,0,0); stroke-width: 1.5; stroke-dasharray: none; stroke-linecap: round; stroke-dashoffset: 0; stroke-linejoin: round; stroke-miterlimit: 4; fill: none; fill-rule: nonzero; opacity: 1;" transform=" translate(-12, -12)" d="M 22 12 C 19.333 16.667 16 19 12 19 C 8 19 4.667 16.667 2 12 C 4.667 7.333 8 5 12 5 C 16 5 19.333 7.333 22 12" stroke-linecap="round" />
									</g>
									</g>
									</g>
							</svg>		  
						</div>
						
					  </div>
				  </div>
			   </div>
                <div class="flex  mt-4 mb-8 border-t justify-between px-6">
                    <div class="w-2/4">
                        <div class="mb-2">
                        <label class="w-1/4 text-gray-700 font-semibold mb-2 py-2" for="datereg">
                            Date :
                        </label>
                        <input
                            class=" border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline "
                            type="date"
                            id="datereg"
                            name="datereg"
                            x-model="date"
                        >
                    </div>   
                    <div class="mb-2">
                        <label class=" text-gray-700 font-semibold mb-2" for="bon_commande">
                            Bon Livraison Source :
                        </label>
                        <select
                            class="appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline cursor-pointer"
                            id="bon_commande"
                            name="bon_commande"
                            x-model="bonlivraison"
                            x-on:change="
                                getProducts($event.target.value);
                                client = $event.target.selectedOptions[0].dataset.client
                                client_name = $event.target.selectedOptions[0].dataset.clientname
                                frais = (parseFloat($event.target.selectedOptions[0].dataset.frais) * 1.19).toFixed(0)
                            "
                            required
                        >
                            <option value="" disabled selected>Selectionner Bon Livraison </option>
                            {% for bon in bonsLivraison %}
                                <option value="{{bon.idBon}}" data-clientname="{{bon.client.name}}" data-client="{{bon.client.id}}" data-frais="{{bon.fraisLivraison}}"> {{ bon.idBon }} </option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="mb-2">
                        <label class="block text-gray-700 font-semibold mb-2" for="bon_commande">
                            Etat de livraison :
                        </label>
                        <select
                            class="appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline cursor-pointer"
                            id="bon_commande"
                            name="bon_commande"
                            x-model="ferme"
                            x-on:change="partial = $event.target.value == 'true' ? false : true; "
                            required
                        >

                            <option value="" disabled selected>Selectionner etat de livraison </option>
                            <option value="true">Complété</option>
                            <option value="false">Non-Complété</option>
                        </select>
                    </div>
	  
				
				  </div>

			   </div>
               	<div x-data="{ tab: 1 }" x-cloak class="my-10 px-6 antialiased border-b-2">
				  <div class="relative flex flex-col rounded-lg shadow-xs overflow-hidden">         
					  <div class="flex space-x-8 bg-white border-b border-gray-200 ">
						  <button
							  type="button"
							  class="focus:outline-none text-black py-2 px-1 border-t-2 text-md tracking-wide font-semibold border-transparent"
							  x-on:click="tab = 1"
							  :class="{ 'text-white  border-gray-700 rounded-t-lg bg-gray-700': tab === 1 }"
						    >
							  Bon de Transport
						  </button>								  
						  <button
							  type="button"
							  class="focus:outline-none text-black py-2 px-1 border-t-2 text-md tracking-wide font-semibold border-transparent"
							  x-on:click="tab = 3"
                              x-show="partial"
							  :class="{ 'text-white  border-gray-700 rounded-t-lg bg-gray-700': tab === 3 }"
                            >
                            Produits Livré
                          </button>						  
					  </div>     
					  <div class="">
						  <div x-show="tab === 1">
                                <div class="p-4 max-w-4xl relative left-0 right-0 overflow-hidden ">
                                    <div class=" w-full  bg-white overflow-hidden block ">		
                                        <div class="form-input">                        
                                            <div class="flex space-x-4 w-full">
                                                <div class="mb-2">
                                                    <label class="block text-gray-700 font-semibold mb-2" for="Port_debarquement">
                                                        Moyen de transport :
                                                    </label>
                                                    <select
                                                        class="appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline cursor-pointer"
                                                        id="moyen_transport"
                                                        name="moyen_transport"
                                                        x-model="moyen_transport"
                                                        x-on:change="name_moyentransport = $event.target.options[$event.target.selectedIndex].text"
                                                        required
                                                    >

                                                        <option value="" disabled selected>Selectionner Moyen de transport </option>
                                                        {% for moyen in moyens_transport %}
                                                            <option value="{{moyen.id}}">{{moyen.designation}} - {{ moyen.immatriculation }}</option>
                                                        {% endfor %}
                                                    </select>
                                                </div>

                                                <div class="mb-2">
                                                    <label class="block text-gray-700 font-semibold mb-2" for="port_embarquement">
                                                        Nom & Prénom du Chauffeur:
                                                    </label>
                                                    <input
                                                        class="appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                                                        type="text"
                                                        id="chauffeur"
                                                        name="chauffeur"
                                                        x-model="chauffeur"
                                                        placeholder="Nom Complet Chauffeur..."
                                                    >
                                                </div>
                                            </div>
                                            <div class="mb-4">
                                                <label class="w-1/4 text-gray-700 font-semibold mb-2 py-2" for="client">
                                                    Client :
                                                </label>
                                                <select
                                                    class="border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline cursor-pointer"
                                                    id="client"
                                                    name="client"		
                                                    x-model = "client"		
                                                    x-on:change=" client = $event.target.selectedOptions[0].dataset.client "		
                                                    required  
                                                    disabled
                                                >
                                                    <option value="" disabled selected> Client </option>
                                                    {% for client in clients  %}
                                                        <option value="{{client.id}}"> {{client.name}} </option>
                                                    {% endfor %}
                                                </select>
                                            </div>          
                                            <div class="mb-2">
                                                <label class="block text-gray-700 font-semibold mb-2" for="adresse_livraison">
                                                    Adresse Livraison
                                                </label>
                                                <input
                                                    class="appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                                                    type="text"
                                                    id="adresse"
                                                    name="adresse"
                                                    x-model="adresse"
                                                    placeholder="Adresse de Livraison..."
                                                >
                                            </div>

                                            <div class="mb-2">
                                                <label class="block text-gray-700 font-semibold mb-2" for="etat">
                                                    Frais Livraison :
                                                </label>
                                                <input
                                                    class="appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                                                    type="number"
                                                    id="frais"
                                                    name="frais"
                                                    x-model="frais_livraison()"
                                                    disabled
                                                    placeholder="Frais de Livraison..."
                                                >
                                            </div>
                                        </div>
                                    </div>
                                </div> 
                           </div> 
                             <div class="w-full" x-show="tab === 3">    
								<table class=" mt-2 border-collapse border-l border-r w-full">
									<thead class="border-b  bg-gray-100  border-t  py-4">
										<tr class="border-b py-4">										
											<th class="text-center ">
												<p class="text-gray-800 uppercase tracking-wide text-sm py-4 font-bold">Référence</p>
											</th>
											<th class="text-center">
												<p class="text-gray-800 uppercase tracking-wide text-sm  py-4 font-bold">Désignation</p>
											</th>											
											
											<th class="text-center">
												<p class="text-gray-800 uppercase tracking-wide text-sm py-4 font-bold">Quantité Sur Bon Livraison</p>
											</th>
											<th class="text-center">
												<p class="text-gray-800 uppercase tracking-wide text-sm py-4 font-bold">Quantité Livré</p>
											</th>
											<th class="px-1 text-center"></th>
										</tr>
									</thead>
									<tbody >
									  <template x-for="invoice in items">
										<tr class=" -mx-1 py-2 border-b">											
											<td class="px-1 text-center">
												<p class="text-gray-800" x-text="invoice.ref"></p>
											</td>
											<td class="px-1 text-center">
												<p class="text-gray-800" x-text="invoice.name"></p>
											</td>										
											<td class="px-1 text-center">
												<p class="text-gray-800" x-text="invoice.qtyBl"></p>
											</td>
											<td class="px-1 text-center">
												<p class="text-gray-800" x-text="invoice.qty"></p>
											</td>											
											<td class="text-center flex items-center">
												<a href="#" class="text-green-950 text-sm font-semibold" @click.prevent="editItem(invoice)">{% heroicon_mini "pencil-square" class="transition-transform" %}</a>
												<input type="checkbox" x-model="invoice.selected" class="mr-2" />
											</td>
										</tr>
									  </template>
									</tbody>
								</table>
								<div class="flex justify-between ">
									<div></div>
									<button @click="deleteSelectedItems" class="text-red-500 hover:text-red-700 px-4 py-2 rounded-md" x-show="items.length > 0">
										{% heroicon_mini "trash" %}
									</button>
								</div>
								<button class="mt-6 bg-white hover:bg-gray-100 text-gray-700 font-semibold py-2 px-4 text-sm border border-gray-300 rounded shadow-sm" x-on:click="showModal">
									Ajouter des produits
								</button>
						  </div>     
                            <div class="mt-8 text-right">
                                <button type="button" class="bg-white hover:bg-gray-100 text-gray-700 font-semibold py-2 px-4 border border-gray-300 rounded shadow-sm mr-2" @click="isOpen = false">
                                Annuler
                                </button>	
                                <button type="button" class="bg-black hover:bg-gray-700 text-white font-semibold py-2 px-4 border border-gray-700 rounded shadow-sm" @click="validateReglement()">
                                Valider
                                </button>	
                            </div>
       </div> 


        <!-- Print Template -->
            <div id="js-print-template" x-ref="printTemplate" class="hidden">
                <div class="py-4 border-b border-stone-500">
                    <img src="{% static 'media/divatech-logo.png' %}" alt="">
                </div>
        

                <h2 class="text-3xl font-bold mt-2 mb-6 pb-2 text-center border-b tracking-wider uppercase">Bon de transport </h2>
                <div class="block w-full  space-y-4 mb-10">
                    <div class="w-full border border-black">
                        <div class="px-4 py-3 ">		
                            <div class="mb-1 flex items-center">
                                <label class="w-32 text-black block font-bold text-xs uppercase tracking-wide">Référence de Bon.</label>
                                <span class="mr-4 inline-block">:</span>
                                <div x-text="referenceBon"></div>
                            </div>				
                            <div class="mb-1 flex items-center">
                                <label class="w-32 text-black block font-bold text-xs uppercase tracking-wide">Date de Bon</label>
                                <span class="mr-4 inline-block">:</span>
                                <div x-text="date"></div>
                            </div>
                            <div class="mb-1 flex items-center">
                                <label class="w-20 text-black block font-bold text-xs uppercase tracking-wide">Bon Livraison Associé </label>
                                <span class="mr-4 inline-block">:</span>
                                <div x-text="bonlivraison"></div>
                            </div>
                        </div>
                    </div>
                    <div class=" border border-black">
                        <div class="px-4 py-3 ">
                            <div class="mb-1 flex items-center">
                                <label class="w-20 text-black block font-bold text-xs uppercase tracking-wide">Moyen Transport </label>
                                <span class="mr-4 inline-block">:</span>
                                <div x-text="name_moyentransport"></div>
                            </div>
                            <div class="mb-1 flex items-center">
                                <label class="w-20 text-black block font-bold text-xs uppercase tracking-wide">Chauffeur </label>
                                <span class="mr-4 inline-block">:</span>
                                <div x-text="chauffeur"></div>
                            </div>
                            <div class="mb-1 flex items-center">
                                <label class="w-20 text-black block font-bold text-xs uppercase tracking-wide">Client </label>
                                <span class="mr-4 inline-block">:</span>
                                <div x-text="client_name"></div>
                            </div>								
                            <div class="mb-1 flex items-center">
                                <label class="w-20 text-black block font-bold text-xs uppercase tracking-wide">Adresse Livraison </label>
                                <span class="mr-4 inline-block">:</span>
                                <div x-text="adresse"></div>
                            </div>								
                            							
                        </div>
                    </div>
                </div>
                <div class=" flex justify-between border-t border-b py-4 border-black mt-12 mr-0">
                    <div></div>
                    <div class="font-bold flex">
                                <label class="w-24 text-black block font-bold text-xs uppercase tracking-wide">Frais Livraison </label>
                                <span class="mr-4 inline-block">:</span>
                                <div x-text="frais +' DZD'"></div>
                    </div>
                </div>
                <div class=" flex justify-between mt-12 mr-0">
                    <div></div>
                    <div class="font-bold">
                    Cachet et Signature
                    </div>
                </div>
            </div>
        <!-- /Print Template -->
           <!-- Modal -->
		  <div style=" background-color: rgba(0, 0, 0, 0.8); " class="fixed z-40 top-0 right-0 left-0 bottom-0 h-full w-full" x-cloak x-show.transition.opacity="openModal">
			  <div class="p-4 max-w-xl mx-auto relative left-0 right-0 overflow-hidden mt-24">
				  <div class="shadow absolute right-0 top-0 w-10 h-10 rounded-full bg-white text-gray-500 hover:text-gray-800 inline-flex items-center justify-center cursor-pointer"
					 x-on:click="openModal = !openModal">
					 <svg class="fill-current w-6 h-6" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
						 <path
							 d="M16.192 6.344L11.949 10.586 7.707 6.344 6.293 7.758 10.535 12 6.293 16.242 7.707 17.656 11.949 13.414 16.192 17.656 17.606 16.242 13.364 12 17.606 7.758z" />
					 </svg>
				  </div>
				  <form action="" id="myForm">
					 <div class="shadow w-full rounded-lg bg-white overflow-hidden block p-8">		
					 <h2 class="font-bold text-2xl mb-6 text-gray-800 border-b pb-2">Ajouter Les Produits Livré</h2>
						 <div class="mb-4">
                            <label class="block text-gray-700 font-semibold mb-2" for="product">
                                Product Name or Code:
                            </label>
                            <select
                                class="appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                                id="product"
                                name="product"
                                x-model="item.ref"
                                x-on:change="
                                item.ref = $event.target.value;
                                item.name=$event.target.selectedOptions[0].dataset.name;
                                item.qtybl = $event.target.selectedOptions[0].dataset.quantity;
                                item.livraison_rate = $event.target.selectedOptions[0].dataset.livraison;
                                showQuantity = true;
                                selectedProductQuantity =  $event.target.selectedOptions[0].dataset.quantity; "
                                required  
                                >
                                <option value="" selected disabled>Produits de BL</option>
                                <template x-for="product in stock" >
                                    <option :value="product.ref" :data-name ="product.name" :data-livraison="product.livraison_rate" :data-quantity="product.qty" x-text="product.name"></option>
                                </template>										 
                            </select>
						 </div>
					 
						 <div class="mb-4">
							 <label class="block text-gray-700 font-semibold mb-2" for="quantity">
								 Quantity Livré:
							 </label>
							 <input
							 class="appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
							 type="number"
							 id="quantity"
							 name="quantity"
							 placeholder="Enter quantity"
							 min="1"
							 required
							 x-model="item.qty"

							 >

							 <div class="mb-4" id="productQuantityDiv" style="display: none;" x-show="showQuantity" >
							 <label class="block text-primary font-medium text-sm mb-2">
								 Quantité sur le bon de livraison  : <span id="productQuantity" x-text="selectedProductQuantity"></span>
							 </label>
							 </div>
						 </div>

			 
						 <div class="mt-8 text-right">
						 <button type="button" class="bg-white hover:bg-gray-100 text-gray-700 font-semibold py-2 px-4 border border-gray-300 rounded shadow-sm mr-2" @click="openModal = !openModal">
							 Cancel
						 </button>	
						 <button type="button" class="bg-gray-800 hover:bg-gray-700 text-white font-semibold py-2 px-4 border border-gray-700 rounded shadow-sm" @click="addItem()">
						 <span >Valider</span>
						 </button>	
						 </div>
					 </div> 
					 </div>
				  </form>
		      </div>
		  </div>
		 <!-- /Modal -->
      </div>
   
     <!-- /Modal -->
        <script>
        function reglement(){
            return {
                referenceBon:'{{reference}}',
                date :new Date().toISOString().slice(0, 10),
                bonlivraison:'',
                ferme:'',
                partial:false,
                moyen_transport:'',
                chauffeur:'',
                client:'',
                client_name:'',
                name_moyentransport:'',
                adresse:'',
                frais:'',
                showQuantity:false,
                selectedProductQuantity:false,
                openModal: false,
                printInvoice() {
                    var printContents = this.$refs.printTemplate.innerHTML;
                    var originalContents = document.body.innerHTML;
                    document.body.innerHTML = printContents;
                    window.print();
                    document.body.innerHTML = originalContents;
                    this.items=[];
                },
                frais_livraison(){
                    if (!this.partial){
                        return this.frais;    
                    }else{
                       return (this.items.reduce((sum, item) => sum + (item.livraison_rate * item.qty), 0)* 1.19).toFixed(0);     
                    }
                },
                items: [],
                stock:[],
                item: {
						 id: '',
						 name: '',
						 ref:'',
						 ent:'',
						 qty: 0,
						 etat:'',
						 reintegre:false,
						 rate: 0,
						 total: 0,
						 gst: 0,
				},
                showModal(){
					 document.getElementById('myForm').reset(); 
					 this.showQuantity = false; 
					 this.openModal =true;
				},

                getProducts(bonL){
				   dataObj={
					   bonL : bonL,						 
				   }
					axios.post('/ventes/fetchProducts/', dataObj, {
						headers: {
						'Content-Type': '',
						'X-CSRFToken': getCookie('csrftoken'),
						}
					})
					.then((response) => {
						console.log(response.data.produits) 
						itemsData=response.data.produits;
						for (const itemData of itemsData) {
							console.log(itemData.entrepot)						 
							const item = {
								name: itemData.produit_name,
								ref: itemData.produit_ref,
								qty: itemData.produit_qty,	
                                livraison_rate: itemData.produit_livraison,						
							};
							this.stock.push(item);
						}						 
					})
					.catch((error) => {
						alert(error)
					});
				  },
							  
				    addItem() {
						 this.items.push({
							 name: this.item.name,
							 ref:this.item.ref,
							 qty: this.item.qty,
                             qtyBl: this.item.qtybl, 
                             livraison_rate: this.item.livraison_rate,							
						 })
                         console.log(this.items);
						 this.item.id = '';
						 this.item.name = '';
						 this.item.qty = 0;
                         this.item.qtybl = 0;
						 document.getElementById('myForm').reset(); 
						 this.showQuantity = false; 
						 this.openModal=false;
				    },

               
                validateReglement(){
                    const dataObj = {
                        referenceBon:this.referenceBon,
                        date :this.date,
                        bonlivraison: this.bonlivraison,
                        etat_livraison: this.ferme,
                        moyen_transport: this.moyen_transport,
                        client:this.client,
                        partial: this.partial,
                        chauffeur: this.chauffeur,
                        produits : this.items,
                        adresse:this.adresse,
                        frais:this.frais,
                    };
                    
                        axios.post('', {
                        formData: dataObj
                        }, {
                        headers: {
                        'Content-Type': '',
                        'X-CSRFToken': getCookie('csrftoken'),
                        }
                    })
                    .then((response) => {
                    data= response.data
                    if(data.success){
                        alert("Bon Transport Créé! vous pouvez l'imprimer!");
                        window.location.href="/logistiques/bons_transport"
                    }else{
                        alert("une erreur a été Survenuer!"); 
                    }		  
                    })
                    .catch((error) => {
                        alert(error);
                    });				
                }, 
            }
        }
        function getCookie(name) {
        var cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            var cookies = document.cookie.split(';');
            for (var i = 0; i < cookies.length; i++) {
            var cookie = cookies[i].trim();
            // Does this cookie string begin with the name we want?
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
            }
        }
        return cookieValue;
        }
        </script>

    </main>
	<!-- end Main content  -->

  </div>
</div>
</div>
</div>
{% endblock content %}